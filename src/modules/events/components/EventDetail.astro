---
import type { EventEntry } from "@app-types/event";
import { formatDate, isFutureDate } from "@utils/formatDate";

interface Props {
  event: EventEntry;
}

const { event }: Props = Astro.props;

const isUpcoming = isFutureDate(event.date);
---

<article class="container-custom section">
  <div class="max-w-3xl mx-auto">
    <!-- Back link -->
    <a
      href="/events"
      class="inline-flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors mb-8"
    >
      <svg
        class="w-5 h-5"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        stroke-width="2"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
      </svg>
      Volver a eventos
    </a>

    <!-- Header -->
    <header class="mb-8">
      <!-- Status badge -->
      {
        isUpcoming && (
          <span class="inline-flex items-center gap-2 px-3 py-1 text-sm font-medium bg-success/10 text-success rounded-full mb-4">
            <span class="w-2 h-2 rounded-full bg-success animate-pulse" />
            Evento próximo
          </span>
        )
      }

      <h1 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-foreground mb-4">
        {event.title}
      </h1>

      <p class="text-xl text-muted-foreground mb-6">
        {event.summary}
      </p>

      <!-- Meta info -->
      <div class="flex flex-wrap gap-4 text-muted-foreground">
        <!-- Date -->
        <div class="flex items-center gap-2">
          <svg
            class="w-5 h-5 text-primary"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5"
            ></path>
          </svg>
          <time datetime={event.date.toISOString()}>{formatDate(event.date)}</time>
        </div>

        <!-- Location -->
        {
          event.location && (
            <div class="flex items-center gap-2">
              <svg
                class="w-5 h-5 text-primary"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"
                />
              </svg>
              <span>{event.location}</span>
            </div>
          )
        }
      </div>
    </header>

    <!-- Event image -->
    <div class="aspect-video rounded-2xl overflow-hidden bg-gradient-to-br from-primary/20 to-accent/20 mb-8">
      <img
        src={event.image || `/images/events/${event.slug}.jpg`}
        alt={event.title}
        class="w-full h-full object-cover"
        loading="lazy"
        onerror="this.style.display='none'"
      />
    </div>

    <!-- Content slot for markdown content -->
    <div class="prose-custom">
      <slot />
    </div>

    <!-- CTA -->
    {
      event.eventUrl && (
        <div class="mt-8 p-6 rounded-2xl bg-primary/5 border border-primary/20">
          <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
            <div>
              <h3 class="font-semibold text-foreground mb-1">
                ¿Te interesa este evento?
              </h3>
              <p class="text-sm text-muted-foreground">
                Obtén más información y regístrate.
              </p>
            </div>
            <a
              href={event.eventUrl}
              target="_blank"
              rel="noopener noreferrer"
              class="inline-flex items-center gap-2 px-6 py-3 bg-primary text-primary-foreground rounded-xl font-medium hover:bg-primary/90 transition-all duration-200 shadow-lg shadow-primary/25"
            >
              Ir al evento
              <svg
                class="w-5 h-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
                />
              </svg>
            </a>
          </div>
        </div>
      )
    }
  </div>
</article>
